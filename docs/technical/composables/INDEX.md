# Composables โ ะะณะปะฐะฒะปะตะฝะธะต

> ะะตัะฐะปัะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั ะดะปั ะบะฐะถะดะพะณะพ composable, ัะพะทะดะฐะฝะฝะพะณะพ ะฟัะธ ัะตัะฐะบัะพัะธะฝะณะต CanvasBoard.vue

## ะะฑะทะพั

ะัะต composables ะฝะฐัะพะดัััั ะฒ `src/composables/` ะธ ะฟัะตะดััะฐะฒะปััั ัะพะฑะพะน 
ะฟะตัะตะธัะฟะพะปัะทัะตะผัะต ััะฝะบัะธะธ ั ัะตะฐะบัะธะฒะฝัะผ ัะพััะพัะฝะธะตะผ (Vue 3 Composition API).

## ะกะฟะธัะพะบ composables

### ะะตะฝะดะตัะธะฝะณ ะธ ะพััะธัะพะฒะบะฐ

| ะคะฐะนะป | ะะพะบัะผะตะฝัะฐัะธั | ะะฟะธัะฐะฝะธะต |
|------|--------------|----------|
| useCanvasImageRenderer.js | [๐ ะะพะบัะผะตะฝัะฐัะธั](useCanvasImageRenderer.md) | ะะตะฝะดะตัะธะฝะณ ะธะทะพะฑัะฐะถะตะฝะธะน ะฝะฐ Canvas2D, ะบััะธัะพะฒะฐะฝะธะต, ะฒะธัััะฐะปะธะทะฐัะธั |

### ะะทะฐะธะผะพะดะตะนััะฒะธะต ั ะพะฑัะตะบัะฐะผะธ

| ะคะฐะนะป | ะะพะบัะผะตะฝัะฐัะธั | ะะฟะธัะฐะฝะธะต |
|------|--------------|----------|
| useCanvasDrag.js | [๐ ะะพะบัะผะตะฝัะฐัะธั](useCanvasDrag.md) | Drag & drop ะบะฐััะพัะตะบ, ััะธะบะตัะพะฒ, ะธะทะพะฑัะฐะถะตะฝะธะน |
| useCanvasSelection.js | [๐ ะะพะบัะผะตะฝัะฐัะธั](useCanvasSelection.md) | ะัะดะตะปะตะฝะธะต ะพะฑัะตะบัะพะฒ ัะฐะผะบะพะน |
| useImageResize.js | [๐ ะะพะบัะผะตะฝัะฐัะธั](useImageResize.md) | ะะทะผะตะฝะตะฝะธะต ัะฐะทะผะตัะฐ ะธะทะพะฑัะฐะถะตะฝะธะน |
| useCanvasFocus.js | [๐ ะะพะบัะผะตะฝัะฐัะธั](useCanvasFocus.md) | ะฆะตะฝััะธัะพะฒะฐะฝะธะต viewport ะฝะฐ ะพะฑัะตะบัะฐั |

### ะกะพะตะดะธะฝะตะฝะธั

| ะคะฐะนะป | ะะพะบัะผะตะฝัะฐัะธั | ะะฟะธัะฐะฝะธะต |
|------|--------------|----------|
| useCanvasConnections.js | [๐ ะะพะบัะผะตะฝัะฐัะธั](useCanvasConnections.md) | ะะธะฝะธะธ ะผะตะถะดั ะบะฐััะพัะบะฐะผะธ |
| useAvatarConnections.js | [๐ ะะพะบัะผะตะฝัะฐัะธั](useAvatarConnections.md) | ะกะพะตะดะธะฝะตะฝะธั ะผะตะถะดั ะฐะฒะฐัะฐัะฐะผะธ |

### ะะธะทะฝะตั-ะปะพะณะธะบะฐ

| ะคะฐะนะป | ะะพะบัะผะตะฝัะฐัะธั | ะะฟะธัะฐะฝะธะต |
|------|--------------|----------|
| useActivePv.js | [๐ ะะพะบัะผะตะฝัะฐัะธั](useActivePv.md) | ะะพะณะธะบะฐ Active PV, ะฐะฝะธะผะฐัะธะธ ะฑะฐะปะฐะฝัะฐ |
| useNoteWindows.js | [๐ ะะพะบัะผะตะฝัะฐัะธั](useNoteWindows.md) | ะะบะฝะฐ ะทะฐะผะตัะพะบ ะบะฐััะพัะตะบ |

### UI

| ะคะฐะนะป | ะะพะบัะผะตะฝัะฐัะธั | ะะฟะธัะฐะฝะธะต |
|------|--------------|----------|
| useCanvasContextMenus.js | [๐ ะะพะบัะผะตะฝัะฐัะธั](useCanvasContextMenus.md) | ะะพะฝัะตะบััะฝัะต ะผะตะฝั |

## ะกัะฐัะธััะธะบะฐ

| Composable | ะกััะพะบ | ะกะปะพะถะฝะพััั |
|------------|-------|-----------|
| useCanvasImageRenderer.js | ~700 | ๐ด ะััะพะบะฐั |
| useAvatarConnections.js | ~688 | ๐ด ะััะพะบะฐั |
| useCanvasDrag.js | ~636 | ๐ด ะััะพะบะฐั |
| useActivePv.js | ~450 | ๐ ะกัะตะดะฝัั |
| useCanvasSelection.js | ~373 | ๐ ะกัะตะดะฝัั |
| useImageResize.js | ~369 | ๐ ะกัะตะดะฝัั |
| useCanvasConnections.js | ~226 | ๐ข ะะธะทะบะฐั |
| useCanvasFocus.js | ~180 | ๐ข ะะธะทะบะฐั |
| useNoteWindows.js | ~170 | ๐ข ะะธะทะบะฐั |
| useCanvasContextMenus.js | ~151 | ๐ข ะะธะทะบะฐั |
| **ะัะพะณะพ** | **~3943** | |

## ะััะธัะตะบัััะฐ

```
CanvasBoard.vue (ะพัะบะตัััะฐัะพั)
        โ
        โโโโ useCanvasImageRenderer โโโ Canvas2D ัะตะฝะดะตัะธะฝะณ
        โ
        โโโโ useCanvasDrag โโโโโโโโโโโโ ะะตัะตะผะตัะตะฝะธะต ะพะฑัะตะบัะพะฒ
        โ         โ
        โ         โโโโ activeGuides (snap ะบ ะฝะฐะฟัะฐะฒะปัััะธะผ)
        โ
        โโโโ useCanvasSelection โโโโโโโ ะัะดะตะปะตะฝะธะต ัะฐะผะบะพะน
        โ
        โโโโ useImageResize โโโโโโโโโโโ ะะทะผะตะฝะตะฝะธะต ัะฐะทะผะตัะฐ
        โ
        โโโโ useCanvasConnections โโโโโ ะะธะฝะธะธ ะบะฐััะพัะตะบ
        โ
        โโโโ useAvatarConnections โโโโโ ะะธะฝะธะธ ะฐะฒะฐัะฐัะพะฒ
        โ         โ
        โ         โโโโ useBezierCurves (ะผะฐัะตะผะฐัะธะบะฐ)
        โ
        โโโโ useActivePv โโโโโโโโโโโโโโ PV ะปะพะณะธะบะฐ
        โ
        โโโโ useCanvasFocus โโโโโโโโโโโ ะคะพะบััะธัะพะฒะบะฐ
        โ         โ
        โ         โโโโ usePanZoom (ะทัะผ/pan)
        โ
        โโโโ useNoteWindows โโโโโโโโโโโ ะะฐะผะตัะบะธ
        โ
        โโโโ useCanvasContextMenus โโโโ ะะพะฝัะตะบััะฝัะต ะผะตะฝั
```

## ะะฐััะตัะฝ ะธัะฟะพะปัะทะพะฒะฐะฝะธั

```javascript
// 1. ะะผะฟะพัั
import { useCanvasDrag } from '@/composables/useCanvasDrag'

// 2. ะะฝะธัะธะฐะปะธะทะฐัะธั ั ะทะฐะฒะธัะธะผะพัััะผะธ
const {
  dragState,
  startDrag,
  handleDrag,
  endDrag,
} = useCanvasDrag({
  cardsStore,
  stickersStore,
  imagesStore,
  // ... ะดััะณะธะต ะทะฐะฒะธัะธะผะพััะธ
})

// 3. ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะฒ template ัะตัะตะท return ะธะปะธ ะฝะฐะฟััะผัั
<div @mousedown="(e) => startDrag(e, targets)">
```

## ะะฑัะธะต ะฟัะธะฝัะธะฟั

1. **ะะดะธะฝััะฒะตะฝะฝะฐั ะพัะฒะตัััะฒะตะฝะฝะพััั** โ ะบะฐะถะดัะน composable ะดะตะปะฐะตั ะพะดะฝั ะฒะตัั
2. **ะะฝัะตะบัะธั ะทะฐะฒะธัะธะผะพััะตะน** โ stores ะธ ััะฝะบัะธะธ ะฟะตัะตะดะฐัััั ะฟะฐัะฐะผะตััะฐะผะธ
3. **ะะตะฐะบัะธะฒะฝะพััั** โ ะธัะฟะพะปัะทััััั ref/computed ะดะปั ัะพััะพัะฝะธั
4. **ะงะธัััะต ััะฝะบัะธะธ** โ ะผะธะฝะธะผัะผ side effects
5. **Throttling** โ ะดะปั ัะฐัััั ัะพะฑััะธะน (mousemove) ะธัะฟะพะปัะทัะตััั throttle
