# TASK_FOR_CLAUDE_CODE: Финализация интеграции Tribute Webhook

## 1. Контекст проекта
- **Репозиторий**: FOHOW-proekt-v3 (Vue 3/Pinia, Fastify/PostgreSQL).
- **Реализация**: Логика webhook находится в `api/routes/tribute.js` и `api/services/tributeService.js`.
- **Текущий статус**: Код написан, маршруты зарегистрированы в `server.js`, функционал протестирован на реальном сервере.

## 2. Выполненные работы
- Создана техническая документация API: `docs/technical/api/routes/tribute.md` и `plans.md`.
- Создана документация сервиса: `docs/technical/services/tributeService.md`.
- Создана инструкция по настройке: `docs/TRIBUTE_WEBHOOK_SETUP.md`.
- **Тестирование**: Проведен успешный тест (id=80):
  - Тариф изменен с 5 (Guest) на 6 (Individual).
  - Подписка продлена на 1 месяц.
  - Уведомление в Telegram доставлено.

## 3. Результат
- Webhook `POST /api/webhook/tribute` полностью работоспособен.
- Ошибки "400/404" устранены (маршрут корректно обрабатывает запросы).
- Интеграция готова к приему реальных платежей.

## 4. Ограничения и рекомендации
- **Не переносить** логику в `plans.js` (как предполагалось изначально), так как текущая архитектура с отдельным `tribute.js` модульная и корректная.
- Для работы в продакшене **критически важно** наличие переменной `TRIBUTE_WEBHOOK_SECRET` в `.env`.

## 5. Конкретные задачи (Checklist)
- [x] Диагностика текущего кода (код валиден).
- [x] Создание документации (выполнено и запушено).
- [x] Тестирование end-to-end на сервере (выполнено успешно).
- [x] Подтверждение работоспособности `recalcUserBoardLocks`.

## 6. Ссылки на документацию
- [Настройка Tribute Webhook](../../TRIBUTE_WEBHOOK_SETUP.md)
- [API Route: Tribute](../api/routes/tribute.md)
- [Service: TributeService](../services/tributeService.md)

## 7. Статус задачи
**COMPLETED**. Код изменений не требует. Документация актуализирована и находится в репозитории.
